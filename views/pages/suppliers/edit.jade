extends ../../includes/page
block content
    script.
        var groups_prototype="#{__groups_prototype}";
    
    input.hidden.meta(id='meta__lang', value='#{language}')
    //input.hidden.meta(id='meta__camp_name_en', value='#{supplier.supplier_name_en}')
    input.hidden.meta(id='meta__camp_id', value='#{supplier.supplier_id}')
    //input.hidden.meta(id='meta__grouptype', value='#{supplier.__prototype}')
    .camps.camp_edit(ng-app="ngSuppliers", ng-controller="supllierEditController")
        
        .heading.card.card__shad
            .card__actions
                if(isCamp)
                    .dropdown
                        a.Btn.btn-default(href='/#{language}/suppliers/#{supplier.supplier_id}')=t('suppliers:edit.view')
            if(isNew)
                h2=t('suppliers:new.header_title')
                h4=t('suppliers:new.header_desc')
                input(type='hidden',id='supplier_id' value='#{supplier_id}')
            else
                span.label.label-info #{t(t_prefix+'edit.camp')} # #{supplier.supplier_id}
                h2 #{t('suppliers:edit.title')}: #{supplier.supplier_name_en}
                h6 #{t('suppliers:edit.since')}: #{supplier.created_at}
        .controls.row
            .col-xs-12
                //- Card switcher
                button.Btn.Btn__default.card-switcher#1=t('suppliers:edit.basic_info')
                if(isCamp)
                    button.Btn.Btn__transparent.card-switcher#2=t('suppliers:edit.details')
                //- TODO - test is user is camp manager of this camp
                if(!isNew)
                    button.Btn.Btn__transparent.card-switcher#3=t('suppliers:edit.members')
                    if(isCamp)
                        button.Btn.Btn__transparent.card-switcher#4=t('suppliers:edit.upload')
        .cards--wrapper.card__shad
            //- Card 1
            .card.card-first
                h4=t(t_prefix+'edit.name_and_desc')
                .camp-info.panel
                    .panel-body
                        .details-he.col-md-6
                            .col-xs-12
                                label(for='supplier_name_he')=t('suppliers:edit.name_he')
                                input.form-control(id='supplier_name_he', dir='rtl', name='supplier_name_he', value=(isNew ? '' : '#{supplier.supplier_name_he}'))
                            .col-xs-12
                                label(for='comments')=t('suppliers:edit.comments')
                                textarea.form-control(id='comments', dir='rtl', name='comments')= isNew ? '' : supplier.comments
                        .details-en.col-md-6
                            .col-xs-12
                                label(for='supplier_name_en')=t('suppliers:edit.name_en')
                                input.form-control(id='supplier_name_en', dir='ltr', name='supplier_name_en', value=(isNew ? '' : '#{supplier.supplier_name_en}'), autofocus)
                
                h4=t('suppliers:edit.contact_title')
                .camp-leaders.panel
                    .panel-body
                        .personnel
                            .details-he.col-md-6
                                .col-xs-12
                                    label(for='main_contact_name')=t('suppliers:edit.main_contact')
                                    input.form-control(id='main_contact_name', dir='rtl', name='main_contact_name', value=(isNew ? '' : '#{supplier.main_contact_name}'))
                                .col-xs-12
                                    label(for='main_contact_position')=t('suppliers:edit.main_contact_position')
                                    input.form-control(id='main_contact_position', dir='rtl', name='main_contact_position', value=(isNew ? '' : '#{supplier.main_contact_position}'))
                            .details-he.col-md-6
                                .col-xs-12
                                    label(for='main_contact_phone_number')=t('suppliers:edit.main_contact_phone_number')
                                    input.form-control(type='number',id='main_contact_phone_number', dir='rtl', name='main_contact_phone_number', value=(isNew ? '' : '#{supplier.main_contact_phone_number}'))

                h4=t(t_prefix+'edit.add_info')
                .camp-details.panel
                    .panel-body
                        .camp-location
                            .col-md-4
                                .col-xs-12
                                    label(for='supplier_website_link')=t('suppliers:edit.website_link')
                                    input.form-control(id='supplier_website_link', name='supplier_website_link', value=(isNew ? '' : '#{supplier.supplier_website_link}'))
                            .col-md-4
                                .col-xs-12
                                    label(for='supplier_midmarket_link')=t('suppliers:edit.midmarket_link')
                                    input.form-control(id='supplier_midmarket_link', name='supplier_midmarket_link', value=(isNew ? '' : '#{supplier.supplier_midmarket_link}'))
                            .col-md-4
                                .col-xs-12
                                    label(for='supplier_category')=t('suppliers:edit.category')
                                    select.form-control(id='supplier_category', name='supplier_category')
                                        option(ng-repeat="option in status_options", ng-selected="option.id == '#{supplier.supplier_category}'", value="{{option.id}}") {{option.value}}

            //- Card 3 - Manage Members
            .card.card-third.card__shad.card__padding--even.card-hide.col-xs-12.table-responsive
                .form-inline
                    input.form-control(ng-model='camps_members_add_member', type="text", placeholder="#{t('suppliers:edit.add_member_placeholder')}")
                    button.Btn.Btn__sm(ng-click="addMember()") + #{t('suppliers:members.add_member')}
                .form-group
                    input.form-control(id='camps_members_search_member', ng-model="searchMembers", type="text", placeholder="#{t('suppliers:edit.search_member')}", name="camps_members_search_member" autofocus)
                .row
                    .col-xs-12
                    include partials/members_table
            //- Card 4
            .card.card-forth.card-hide
                h4=t('suppliers:edit.upload_header')
                .camp-members.panel
                    .panel-body
                        .names.col-md-6
                            .col-xs-12
                                label(for='edit_camp_upload_security_file')=t('suppliers:edit.security_file')
                                input.form-control(type="file" id='edit_camp_upload_security_file', name='security_file')

        .controls.row
            .col-xs-12
                if(isNew)
                    a.Btn.Btn__default.card-switcher#2(href='#')=t('suppliers:btn_continue')
                    button(type="submit", id='supplier_create_save', class="Btn Btn__green")=t('suppliers:btn_save_camp')

                else
                    input(id='supplier_edit_supplier_id', type='hidden', value='#{supplier.supplier_id}')
                    button.Btn.Btn__default(id='supplier_edit_save')=t('suppliers:btn_save_camp')
                
                    if isCamp && supplier.web_published != '1'
                        button.Btn.Btn__green(id='camp_edit_publish')=t('suppliers:edit.publish')

        // Camp create request modal
        .modal.fade(id='create_camp_request_modal', tabindex='-1', role='dialog')
            .modal-dialog.card.card__padding--even.card__shad(role='document')
                div
                    .modal-header
                        button.close(type='button', data-dismiss='modal', aria-label='Close')
                            span(aria-hidden='true') Ã—
                        h4.modal-title=t('suppliers:new.create_camp_request')
                    .modal-body
                        p=t('suppliers:new.create_camp_request_text')
                        .camp_details
                            ul
                                li.camp_name_he=t('suppliers:new.name_he')
                                    span
                                li.camp_name_en=t('suppliers:new.name_en')
                                    span
                                li.camp_desc_he=t('suppliers:new.desc_he')
                                    span
                                li.camp_desc_en=t('suppliers:new.desc_en')
                                    span
                                li.contact_person_id=t('suppliers:new.contact_person_id')
                                    span
                                li.facebook_page_url=t('suppliers:new.facebook_page_url')
                                    span
                                li.accept_families=t('suppliers:camps.accept_families')
                                    span
                                li.contact_person_name=t('suppliers:new.contact_person_name')
                                    span
                                li.contact_person_email=t('suppliers:new.contact_person_email')
                                    span
                                li.contact_person_phone=t('suppliers:new.contact_person_phone')
                                    span
                                li.main_contact=t('suppliers:new.main_contact')
                                    span
                                li.moop_contact=t('suppliers:new.moop_contact')
                                    span
                                li.safety_contact=t('suppliers:new.safety_contact')
                                    span
                                li.type=t('suppliers:new.type')
                                    span
                                li.camp_status=t('suppliers:edit.status')
                                    span
                                li.camp_activity_time=t('suppliers:new.camp_activity_time')
                                    span
                                li.child_friendly=t('suppliers:new.camp_child_friendly')
                                    span
                                li.noise_level=t('suppliers:new.camp_noise_level')
                                    span
                                li.public_activity_area_sqm=t('suppliers:new.public_activity_area_sqm')
                                    span
                                li.public_activity_area_desc=t('suppliers:new.public_activity_area_desc')
                                    span
                                li.support_art=t('suppliers:new.support_art')
                                    span
                                li.location_comments=t('suppliers:new.location_comments')
                                    span
                                li.camp_location_street=t('suppliers:new.camp_location_street')
                                    span
                                li.camp_location_street_time=t('suppliers:new.camp_location_street_time')
                                    span
                                li.camp_location_area=t('suppliers:new.camp_location_area')
                                    span
                    .modal-footer
                        button.Btn.Btn__transparent(id='create_camp_close_btn', type='button', data-dismiss='modal')=t('suppliers:new.close')
                        button.Btn.Btn__green(id='supplier_create_save_modal_request', type='button')=t('suppliers:new.send_request')
